<div id="contentbody">
  <h1>DANH SÁCH HỌC SINH</h1>

  <div class="input-group" id="search_div">
    <div class="form-outline">
      <label class="form-label" for="form1">Search</label>
      <div style="display: flex;flex-direction: row;">
        <input type="search" id="form1" class="form-control" />
        <button type="button" class="btn btn-primary">
          Search
        </button>

      </div>
      <button type="button" class="btn btn-primary" (click)="openModal(addstudent)">Thêm học sinh</button>
    </div>

  </div>

  <div>
    <div id="table">
      <table class="table align-middle">
        <thead>
          <tr>
            <th scope="col">ID </th>
            <th scope="col">Name</th>
            <th scope="col">Age</th>
            <th scope="col">Yob</th>
            <th scope="col">ParentsId</th>
            <th scope="col">TeacherId</th>
            <th scope="col">ClassId</th>
            <th scope="col">Chức năng</th>
          </tr>
        </thead>
        <tbody>
          <tr scope="row" *ngFor="let student of this.students">
            <td>{{student._id}}</td>
            <td>{{student.Name}}</td>
            <td>{{student.Age}}</td>
            <td>{{student.Yob}}</td>
            <td>{{student.Parents}}</td>
            <td>{{student.Teacher}}</td>
            <td>{{student.Class}}</td>
            <td>
              <button type="button" class="btn btn-success btn-sm px-3" (click)="this.getStudentDetail(student._id);openModal(studentdetail)">
                Chi tiết
              </button>
              <button type="button" class="btn btn-primary btn-sm px-3" (click)="openModal(updatestudent)">
                Cập nhật
              </button>
              <button type="button" class="btn btn-danger btn-sm px-3">
                Xóa
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<ng-template #addstudent>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Thêm học sinh mới</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <form [formGroup]="addStudentForm">
    <div class="modal-body">
      <div id="addForm">
        <label for="exampleInputEmail1">Họ tên</label>
        <input type="email" class="form-control" placeholder="Nhập tên">
        <label for="exampleInputEmail1">Tuổi</label>
        <input type="email" class="form-control" placeholder="Nhập tuổi">
        <label for="exampleInputEmail1">Ngày sinh</label>
        <div id="YobInput">
          <input type="text" ngbDatepicker #d="ngbDatepicker" placeholder="2021-12-04" />
          <button (click)="d.toggle()">Toggle</button>
        </div>
        <label for="exampleInputEmail1">Id Phụ huynh</label>
        <input type="email" class="form-control" placeholder="Nhập Id Phụ huynh">
        <label for="exampleInputEmail1">Id Giáo viên</label>
        <input type="email" class="form-control" placeholder="Nhập Id Giáo viên">
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modalRef.hide()">Đóng</button>
      <button type="submit" class="btn btn-primary">Thêm mới</button>
    </div>
  </form>
</ng-template>


<ng-template #studentdetail>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Chi tiết của học sinh</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">×</span>
    </button>
  </div>

  <div class="modal-body">
    <div id="addForm">
      <h2>ID học sinh:{{this.selectedStudent._id}}<b></b></h2>
      <p>Tên :{{this.selectedStudent.Name}}</p>
      <p>Tuổi:{{this.selectedStudent.Age}}</p>
      <p>Ngày sinh:{{this.selectedStudent.Yob}}</p>
      <p>Số lượng Phụ huynh: {{this.selectedStudent.Parents.length}}<button (click)="openModal(studentParent)">Xem</button></p>
      <p>ID Giáo viên:</p>
      <p>ID Lớp học:</p>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modalRef.hide()">Đóng</button>
    <button type="submit" class="btn btn-primary">Thêm mới</button>
  </div>

</ng-template>

<ng-template #updatestudent>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Cập nhật thông tin của sinh viên</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <form [formGroup]="addStudentForm">
    <div class="modal-body">
      <div id="addForm">
        <label for="exampleInputEmail1">Họ tên</label>
        <input type="email" class="form-control" placeholder="Nhập tên">
        <label for="exampleInputEmail1">Tuổi</label>
        <input type="email" class="form-control" placeholder="Nhập tuổi">
        <label for="exampleInputEmail1">Ngày sinh</label>
        <div id="YobInput">
          <input type="text" ngbDatepicker #d="ngbDatepicker" placeholder="2021-12-04" />
          <button (click)="d.toggle()">Toggle</button>
        </div>
        <label for="exampleInputEmail1">Id Phụ huynh</label>
        <input type="email" class="form-control" placeholder="Nhập Id Phụ huynh">
        <label for="exampleInputEmail1">Id Giáo viên</label>
        <input type="email" class="form-control" placeholder="Nhập Id Giáo viên">
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modalRef.hide()">Đóng</button>
      <button type="submit" class="btn btn-primary">Thêm mới</button>
    </div>
  </form>
</ng-template>


<ng-template #studentParent>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Phụ huynh của học sinh: {{this.selectedStudent.Name}}</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">×</span>
    </button>
  </div>

    <div class="modal-body">
      <div>
        <div id="table">
          <table class="table align-middle">
            <thead>
              <tr>
                <th scope="col">ID </th>
                <th scope="col">DadName</th>
                <th scope="col">MomName</th>
                <th scope="col">Address</th>
              </tr>
            </thead>
            <tbody>
              <tr scope="row" *ngFor="let parent of this.selectedStudent.Parents">
                <td>{{parent._id}}</td>
                <td>{{parent.DadName}}</td>
                <td>{{parent.MomName}}</td>
                <td>{{parent.Address}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modalRef.hide()">Đóng</button>
      <button type="submit" class="btn btn-primary">Thêm mới</button>
    </div>

</ng-template>
